/*
 * The MIT License (MIT)
 *
 * Copyright ( c ) 2015 Teem2 LLC
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
(function(){var t,e,i=[].slice,n={}.hasOwnProperty,s=function(t,e){function i(){this.constructor=t}for(var s in e)n.call(e,s)&&(t[s]=e[s]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},r=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},o=function(t,e){return function(){return t.apply(e,arguments)}};e={bold:"fontWeight",bordercolor:"borderColor",borderstyle:"borderStyle",bottomborder:"borderBottomWidth",bottompadding:"paddingBottom",boxshadow:"boxShadow",bgcolor:"backgroundColor",ellipsis:"textOverflow",fontfamily:"fontFamily",fontweight:"fontWeight",fontsize:"fontSize",italic:"fontStyle",leftborder:"borderLeftWidth",leftpadding:"paddingLeft",rightborder:"borderRightWidth",rightpadding:"paddingRight",smallcaps:"fontVariant",topborder:"borderTopWidth",toppadding:"paddingTop",visible:"visibility",whitespace:"whiteSpace",x:"marginLeft",y:"marginTop",z:"z-index"},t=function(){var t,i,n,s,r;t={};for(n in e)r=e[n],t[r]=n;return i=$.style,s=function(e,n,s){var r,o;return r=t[n],null==r&&(r=t[n.replace(/-([a-z])/i,function(t){return t[1].toUpperCase()})],r=t[n]=r?r:n),r&&(o=e.$view,o[r]!==s&&o.setAttribute(r,s)),i.apply(this,arguments)},function(t){return $.style=t?s:i}}(),window.dr=function(){var t,n,a,u,l,h,d,p,c,f,g,b,v,_,y,m,w,x,k,A,S,T,E,F,L,H,M,C,z,B,P,N,O,j,I,R,V,W,D,q,X,Y,K,U,G,J,Z,Q,te,ee,ie,ne;return n=window.Node.COMMENT_NODE,D=function(){},S=function(t,e,i){return i||(i=.01),Math.abs(t-e)<i},R=function(){var t,e,n,r,o,a,u,l,h;for(e=arguments[0],a=2<=arguments.length?i.call(arguments,1):[],t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e}(e),n=l=a.length-1;l>=0;n=l+=-1){o=a[n],h=o.prototype;for(u in h)r=h[u],t.prototype[u]=r}return t},I=/%$/,te=null,l={register:function(t,e){var i,n,s,r,o;for(i=t.split(" "),this.hasOwnProperty("events")&&this.events||(this.events={}),r=0,o=i.length;o>r;r++)n=i[r],(s=this.events)[n]||(s[n]=[]),this.events[n].push(e);return this},one:function(t,e){return this.register(t,function(){return this.unregister(t,arguments.callee),e.apply(this,arguments)}),this},trigger:function(t,e,i){var n,s,o,a,u;if(s=this.hasOwnProperty("events")&&(null!=(u=this.events)?u[t]:void 0)){if(te){if(te.scope===this){if(r.call(te,t)>=0)return this;te.push(t)}}else te=[t],te.scope=this;for(o=0,a=s.length;a>o;o++)n=s[o],n.call(this,e,i);return te=null,this}},listenTo:function(t,e,i){return t.register(e,i),this.listeningTo||(this.listeningTo=[]),this.listeningTo.push({obj:t,ev:e,callback:i}),this},listenToOnce:function(t,e,i){var n;return n=this.listeningToOnce||(this.listeningToOnce=[]),n.push(t),t.one(e,function(){var e;return e=n.indexOf(t),-1!==e&&n.splice(e,1),i.apply(this,arguments)}),this},stopListening:function(t,e,i){var n,s,r,o,a,u,l,h,d,p,c,f,g;if(t){for(t.unregister(e,i),c=[this.listeningTo,this.listeningToOnce],a=0,h=c.length;h>a;a++)if(r=c[a])if(n=r.indexOf(t),n>-1)r.splice(n,1);else for(s=u=0,d=r.length;d>u;s=++u)if(o=r[s],t===o.obj&&e===o.ev&&i===o.callback){r.splice(s,1);break}}else{for(f=this.listeningTo,l=0,p=f.length;p>l;l++)g=f[l],t=g.obj,e=g.ev,i=g.callback,t.unregister(e,i);this.listeningTo=void 0}return this},unregister:function(t,e){var i,n,s,r,o,a,u,l,h,d;if(!t)return this.events={},this;for(n=t.split(" "),a=0,l=n.length;l>a;a++)if(o=n[a],r=null!=(d=this.events)?d[o]:void 0)if(e){for(s=u=0,h=r.length;h>u;s=++u)if(i=r[s],i===e){r=r.slice(),r.splice(s,1),this.events[o]=r;break}}else delete this.events[o];return this}},V=["included","extended"],c=function(){function t(){}return t.include=function(t){var e,i,n;if(!t)throw new Error("include(obj) requires obj");for(e in t)i=t[e],r.call(V,e)<0&&(this.prototype[e]=i);return null!=(n=t.included)&&n.call(this,t),this},t}(),P={parent:!0,id:!0,name:!0,"extends":!0,type:!0,scriptincludes:!0},u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return s(e,t),e.include(l),i={number:parseFloat,"boolean":function(t){return"string"==typeof t?"true"===t:!!t},string:function(t){return t+""},json:function(t){return JSON.parse(t)},expression:function(t){return"string"!=typeof t?t:T.compile("return "+t)()},positivenumber:function(t){return t=parseFloat(t),isNaN(t)?0:Math.max(0,t)},emptynumber:function(t){return null==t||""===t?"":parseFloat(t)},size:function(t){return I.test(t)||"auto"===t?t:(t=parseFloat(t),isNaN(t)?0:Math.max(0,t))},x:function(t){var e;if(I.test(t))return t;if("string"==typeof t)switch(e=t.toLowerCase()){case"begin":case"middle":case"end":case"left":case"right":case"center":case"none":return e;default:t=parseFloat(t)}return isNaN(t)?(t=this.x,isNaN(t)?0:t):t},y:function(t){var e;if(I.test(t))return t;if("string"==typeof t)switch(e=t.toLowerCase()){case"begin":case"middle":case"end":case"top":case"bottom":case"center":case"none":return e;default:t=parseFloat(t)}return isNaN(t)?(t=this.y,isNaN(t)?0:t):t}},e.prototype._coerceType=function(t,e,n){var s;if(n||(n=this.types[t]),n){if(F||Q){if(!i[n])return void Y(["Invalid type '"+n+"' for attribute '"+t+"', must be one of: "+Object.keys(i).join(", ")]);try{e=i[n].call(this,e)}catch(r){s=r,Y(["error parsing "+n+" value '"+e+"' for attribute '"+t+"'"])}}else e=i[n].call(this,e);"number"===n&&isNaN(e)&&(e=this[t],isNaN(e)&&(e=0))}else null==e&&(e="");return e},e.prototype.setAttribute=function(t,e,i){var n;return e=this._coerceType(t,e),i||this._unbindConstraint(t),n="set_"+t,"function"==typeof this[n]&&(e=this[n](e),e===D)?this:(t in P?this.setAndFire(t,e):this.defaultSetAttributeBehavior(t,e),this)},e.prototype.defaultSetAttributeBehavior=function(t,e){return this.setAndFire(t,e)},e.prototype.setAndFire=function(t,e){return this.sendEvent(t,this[t]=e)},e.prototype.sendEvent=function(t,e){var i;return N?void H.push({scope:this,name:t,value:e}):((null!=(i=this.events)?i[t]:void 0)&&this.trigger(t,e,this),this)},e.prototype.setAttributes=function(t){var e,i;for(e in t)i=t[e],this.setAttribute(e,i);return this},e}(c),k={localStorage:function(){var t,e;e="dr";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(i){return t=i,!1}}(),touch:"ontouchstart"in window||"onmsgesturechange"in window,camelcss:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,raf:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,prefix:function(){var t,e,i;return i=window.getComputedStyle(document.documentElement,""),e=(Array.prototype.slice.call(i).join("").match(/-(moz|webkit|ms)-/)||""===i.OLink&&["","o"])[1],t="WebKit|Moz|MS|O".match(new RegExp("("+e+")","i"))[1],{dom:t,lowercase:e,css:"-"+e+"-",js:e[0].toUpperCase()+e.substr(1)}}()},q=window.location.search,F=q.indexOf("debug")>0,Q=q.indexOf("test")>0,T=function(){var t,e,i,n,s,r,o,a,u,l,h,d;return a=q.indexOf("nocache")>0,l=q.indexOf("strict")>0,a||(d=k.localStorage),e="dreemcache",t=localStorage.getItem(e),d&&t&&t.length<5e6?n=JSON.parse(t):(localStorage.clear(),n={bindings:{},script:{coffee:{}}},d&&(localStorage[e]=JSON.stringify(n))),window.addEventListener("unload",function(){return d?localStorage[e]=JSON.stringify(n):void 0}),o=function(){var t,e,i;return t=n.bindings,i=null,e={MemberExpression:function(t,e){var n;return"CallExpression"===e.node.type&&"callee"===e.sub?!0:(n=t.property.name,t=t.object,i.push({binding:acorn.stringify(t),property:n}),!0)}},function(n){var s;return d&&n in t?t[n]:(s=acorn.parse(n),i=[],acorn.walkDown(s,e),t[n]=i)}}(),h=function(){var t,e;return t=n.script.coffee,e={coffee:function(e){var i;if(d&&e in t)return t[e];if(!window.CoffeeScript)return void console.warn("missing coffee-script.js include");try{if(e)return t[e]=CoffeeScript.compile(e,{bare:!0})}catch(n){return i=n,Y(["error "+i+" compiling script\r\n"+e])}}},function(t,i){return null==t&&(t=""),i in e?e[i](t):t}}(),u={},s=function(t,e,i){var n,s,r,o;if(null==t&&(t=""),null==e&&(e=[]),null==i&&(i=""),n=e.join(),o=t+n+i,o in u)return u[o];try{return l&&(t='"use strict"\n'+t),r=i?new Function("return function "+i.replace("-","_")+"("+n+"){"+t+"}")():new Function(e,t),u[o]=r}catch(a){return s=a,Y(["Failed to compile "+s.toString()+" "+e+" "+t])}},i=function(t,e,i){var n,s;return null==t&&(t=""),null==e&&(e=[]),null==i&&(i=""),n=e.join(),s=t+n+i,s in u?u[s]:u[s]=new Function(e,t)},r={compile:F?s:i,transform:h,findBindings:o}}(),E=[],N=!1,z=[],H=[],ie=function(){var t,e,i,n,s,r,o,a,u,l;for(N=!1,s=0,a=z.length;a>s;s++)i=z[s],i._bindHandlers();for(z=[],r=0,u=H.length;u>r;r++)t=H[r],i=t.scope,e=t.name,n=t.value,"init"===e&&(i.inited=!0),i.sendEvent(e,n);for(H=[],o=0,l=E.length;l>o;o++)i=E[o],i._bindConstraints();return E=[]},A=function(t){var e,i,n;i={};for(e in t)n=t[e],i[e]=n;return i},ne=function(t,e){var i,n,s,r,o,a,u,l,h,d;if(null!=t["with"])for(r=t["with"].split(",").reverse(),l=0,h=r.length;h>l;l++)s=r[l],n=dr[s.trim()],n&&ne(n.classattributes,e);d=[];for(i in t)u=t[i],"with"!==i&&(("$methods"===i||"$types"===i)&&i in e?(e[i]=A(e[i]),d.push(function(){var t;t=[];for(o in u)a=u[o],t.push("$methods"===i&&e[i][o]?e[i][o]=e[i][o].concat(a):e[i][o]=a);return t}())):d.push("$handlers"===i&&i in e?e[i]=e[i].concat(u):e[i]=u));return d},g=function(t){function e(t,e){var i,n,s,r,o,a,u,h,p,c,f,g,b,v;if(null==e&&(e={}),null!=e["with"]&&(null==e.$tagname&&(h=!0),u={},ne(e,u),e=u,h&&delete e.$tagname),a=e.$methods)for(b=["construct","_createSprite"],p=0,f=b.length;f>p;p++)if(r=b[p],o=a[r])for(c=0,g=o.length;g>c;c++)v=o[c],s=v.method,i=v.args,n=l.test(s),d(this,r,T.compile(s,i,""+e.$tagname+"$"+r).bind(this),n);this.construct(t,e)}var n,o,a,l,h,d;return s(e,t),n=["name","parent"],o=["data","skin"],e.prototype.createChild=function(t,e){var i,n,s;return null==t&&(t={}),null==e&&(e=!1),i=null!=(s=t["class"])?s:"node",delete t["class"],"function"!=typeof dr[i]?void Y(["Unrecognized class "+i+" in createChild()"]):(n=t.element,delete t.element,null==t.parent&&(t.parent=this),new dr[i](n,t,e))},e.prototype.construct=function(t,i){var s,a,u,l,h,d,p,c,f,g,b,v,_,y,m,w,x,k;if(this.subnodes=[],this.types=null!=(y=i.$types)?y:{},delete i.$types,l=i.$skiponinit,delete i.$skiponinit,s=i.$deferbindings,delete i.$deferbindings,null!=t&&(t.$view=this,i.$textcontent=t.textContent),h=i.$tagname,i.$methods&&(this.installMethods(i.$methods,h),delete i.$methods),i.$handlers){if(this.installHandlers(i.$handlers,h),"false"!==i.clickable)for(m=function(){var t,e,n,s,o;for(n=i.$handlers,o=[],t=0,e=n.length;e>t;t++)a=n[t],s=a.ev.substr(2),r.call(W,s)>=0&&o.push(a);return o}(),d=0,g=m.length;g>d;d++){a=m[d],i.clickable=!0;break}delete i.$handlers}s||this._bindHandlers(),w=function(){var t,e,s;for(s=[],t=0,e=n.length;e>t;t++)a=n[t],a in i&&s.push(a);return s}();for(p=0,b=w.length;b>p;p++)a=w[p],this.setAttribute(a,i[a]);for(x=function(){var t;t=[];for(a in i)r.call(o,a)>=0||r.call(n,a)>=0||t.push(a);return t}(),c=0,v=x.length;v>c;c++)a=x[c],this.bindAttribute(a,i[a],h);u=this.parent,u&&u instanceof e&&(u.sendEvent("subnodes",this),u.doSubnodeAdded(this)),k=function(){var t,e,n;for(n=[],e=0,t=o.length;t>e;e++)a=o[e],a in i&&n.push(a);return n}();for(f=0,_=k.length;_>f;f++)a=k[f],this.bindAttribute(a,i[a],h);return this.constraints&&E.push(this),l||this.inited?void 0:this.initialize()},e.prototype.initialize=function(t){return N||(this.inited=!0),t?void 0:this.sendEvent("init",this)},l=/this.super\(|this\["super"\]\(/,e.prototype.installMethods=function(t,e,i,n){var s,r,o,a,u,h,p,c,f;null==i&&(i=this),null==n&&(n=this);for(h in t)for(u=t[h],p=0,c=u.length;c>p;p++)f=u[p],a=f.method,r=f.args,s=f.allocation,"construct"!==h&&"_createSprite"!==h&&(o=l.test(a),d(i,h,T.compile(a,r,""+e+"$"+h).bind(n),o,s))},e.prototype.installHandlers=function(t,e,i){var n,s,r,o,a,u,l,d,p,c;for(null==i&&(i=this),null==this.handlers&&(this.handlers=[]),p=0,c=t.length;c>p;p++)r=t[p],s=r.ev,u=r.name,d=r.script,n=r.args,l=r.reference,a=r.method,s=s.substr(2),r.callback=a?i[a]:h(s,d,i,e,n),o={scope:this,ev:s,name:u,callback:r.callback,reference:l},this.handlers.push(o)},e.prototype.removeHandlers=function(t,e,i){var n,s,r,o,a,u,l,h,d,p;for(null==i&&(i=this),d=0,p=t.length;p>d;d++)r=t[d],s=r.ev,a=r.name,h=r.script,n=r.args,u=r.reference,o=r.method,s=s.substr(2),null!=u?(l=this._valueLookup(u)(),i.stopListening(l,s,r.callback)):i.unregister(s,r.callback)},a=/\${(.+)}/,e.prototype.bindAttribute=function(t,e,i){var n,s,r;return"string"==typeof e&&(n=e.match(a))?this.setConstraint(t,n[1],!0):(s=t.match(j))?(t=s[1],r={scope:this,ev:t,callback:h(t,e,this,i)},this.handlers.push(r)):this.setAttribute(t,e)},h=function(t,e,i,n,s){var r;return null==n&&(n=""),null==s&&(s=["value"]),r=T.compile(e,s,""+n+"$on"+t),function(){var e;return e=arguments.length?arguments:t in i?[i[t]]:[],r.apply(i,e)}},d=function(t,e,n,s){var r,o;return s?(e in t&&"function"==typeof t[e]&&(o=t[e],r=!0),t[e]=function(){var e,s,a,u;return e=1<=arguments.length?i.call(arguments,0):[],s=t.hasOwnProperty("super"),s&&(a=t["super"]),t["super"]=r?function(){var n,s,r;for(r=1<=arguments.length?i.call(arguments,0):[],n=r.length,s=e.splice(0);n;)s[--n]=r[n];return o.apply(t,s)}:D,u=n.apply(t,e),s?t["super"]=a:delete t["super"],u}):t[e]=n},e.prototype.setConstraint=function(t,e,i){var n,s,r,o,a,u;for(null!=this.constraints?this._unbindConstraint(t):this.constraints={},this.constraints[t]={expression:e,bindings:{}},s=this.constraints[t].bindings,o=T.findBindings(e),a=0,u=o.length;u>a;a++)r=o[a],n=r.binding,null==s[n]&&(s[n]=[]),s[n].push(r);i||this._bindConstraints()},e.prototype._valueLookup=function(t){return T.compile("return "+t).bind(this)},e.prototype._unbindConstraint=function(t){var e,i,n,s,r,o,a,u,l;if(this.constraints&&(null!=(u=this.constraints[t])?u.callback:void 0)){for(l=this.constraints[t],e=l.callback,i=l.callbackbindings,n=o=0,a=i.length;a>o;n=o+=2)s=i[n],r=i[n+1],r.unregister(s,e);this.constraints[t]=null}},e.prototype._bindConstraints=function(){var t,e,i,n,s,r,o,a,l,h,d,p,c;c=this.constraints;for(l in c){r=c[l],n=r.bindings,o=r.expression,null==r.callbackbindings&&(r.callbackbindings=[]),a=this._valueLookup(o),r.callback=this._constraintCallback(l,a);for(t in n)if(i=n[t],s=this._valueLookup(t)())for(s instanceof u||console.log("Binding to non-Eventable "+t+" of constraint "+o+" for "+this.$tagname+(this.id?"#"+this.id:this.name?"."+l:"")),d=0,p=i.length;p>d;d++)e=i[d],h=e.property,s instanceof u&&s.register(h,r.callback),r.callbackbindings.push(h,s);else Y(["Could not bind to "+t+" of constraint "+o+" for "+this.$tagname+(this.id?"#"+this.id:this.name?"."+l:"")]);this.setAttribute(l,a(),!0)}},e.prototype._bindHandlers=function(t){var e,i,n,s,r,o,a,l,h,d;if(this.handlers){if(N)return void z.push(this);for(d=this.handlers,l=0,h=d.length;h>l;l++)e=d[l],a=e.scope,s=e.name,n=e.ev,i=e.callback,r=e.reference,r?(o=this._valueLookup(r)(),o instanceof u&&(a.listenTo(o,n,i),t&&n in o&&i(o[n]))):(a.register(n,i),t&&n in a&&i(a[n]));this.handlers=[]}},e.prototype._constraintCallback=function(t,e){return function(){this.setAttribute(t,e(),!0)}.bind(this)},e.prototype.set_parent=function(t){return t instanceof e&&(this.name&&(t[this.name]=this),t.subnodes.push(this)),t},e.prototype.set_name=function(t){return this.parent&&t&&(this.parent[t]=this),t},e.prototype.set_id=function(t){return window[t]=this,t},e.prototype.animate=function(t,e){var i,n,s,r,o,a,u;null==e&&(e=600),s={};for(o in t)u=t[o],a={motion:"bret",control:[.01]},a[0]=this[o]||0,a[e]=u,i=Animator.createAnimator(),i.playStateless(a),s[o]=i;return r=void 0,n=function(t){return function(e){var a,u,l;if(!t.destroyed){null==r&&(r=e),u=e-r,a=!1;for(o in s)i=s[o],l=i.timestep(u),t.setAttribute(o,l),i.ended&&(a=!0);return a?void 0:dr.idle.callOnIdle(n)}}}(this),dr.idle.callOnIdle(n),this},e.prototype._removeFromParent=function(t){var e,i,n;this.parent&&(e=this.parent[t],i=e.indexOf(this),-1!==i&&(n=e[i],e.splice(i,1),this.parent.sendEvent(t,n),"subnodes"===t&&this.parent.doSubnodeRemoved(n)))},e.prototype._findParents=function(t,e){var i,n;for(i=[],n=this;n;)t in n&&n[t]===e&&i.push(n),n=n.parent;return i},e.prototype._findInParents=function(t){var e;for(e=this.parent;e;){if(t in e)return e[t];e=e.parent}},e.prototype.doSubnodeAdded=function(){},e.prototype.doSubnodeRemoved=function(){},e.prototype.destroy=function(t){var e,i,n,s,r,o;if(this.destroyed=!0,this.sendEvent("destroy",this),this.constraints)for(e in this.constraints)this._unbindConstraint(e);for(this.listeningTo&&this.stopListening(),this.unregister(),(null!=(r=this.parent)?r[this.name]:void 0)===this&&delete this.parent[this.name],o=this.subnodes,n=0,s=o.length;s>n;n++)i=o[n],null!=i&&i.destroy(!0);return t?void 0:this._removeFromParent("subnodes")},e}(u),console.log("This is a dali Sprite example."),v=function(){function t(t,e,i){null==i&&(i="div"),this._handleScroll=o(this._handleScroll,this),null==t?(this.el=document.createElement(i),this.el.$init=!0):t instanceof HTMLElement&&(this.el=t),this.el.$view=e,this.css_baseclass="sprite",this._updateClass()}return t.prototype.setAttribute=function(t,e){var i;switch(t){case"width":case"height":case"z":case"opacity":case"bgcolor":case"color":case"whitespace":case"fontsize":case"fontfamily":case"fontweight":case"text-transform":case"boxshadow":case"leftpadding":case"rightpadding":case"toppadding":case"bottompadding":case"leftborder":case"rightborder":case"topborder":case"bottomborder":case"bordercolor":case"borderstyle":return this.setStyle(t,e);case"bold":return this.setStyle(t,e?"bold":"normal");case"italic":return this.setStyle(t,e?"italic":"normal");case"smallcaps":return this.setStyle(t,e?"small-caps":"normal");case"ellipsis":return this.__ellipsis=e,this.setStyle(t,e?"ellipsis":"clip"),this.__updateOverflow();case"perspective":case"transform-style":case"transform-origin":case"transform":return this.setStyle(k.prefix.css+t,e);default:if(i=this.el.$view._declaredTypes,null==i[t])return this.setStyle(t,e)}},t.prototype.setStyle=function(t){return t?function(t,i,n,s){var r,o;return null==s&&(s=this.el),null==i&&(i=""),t in e&&(t=e[t]),s.style[t]=i,"borderTopWidth"===t||"paddingTop"===t?(r=(this.__BP_TOGGLE=!this.__BP_TOGGLE)?-.001:.001,o=s.style.paddingLeft,s.style.paddingLeft=Number(o.substring(0,o.length-2))+r+"px"):void 0}:function(t,i,n,s){return null==s&&(s=this.el),null==i&&(i=""),t in e&&(t=e[t]),s.style[t]=i}}("WebKit"===k.prefix.dom),t.prototype.set_parent=function(e){return e instanceof t&&(e=e.el),this.el.parentNode!==e?e.appendChild(this.el):void 0},t.prototype.set_id=function(t){return this.el.setAttribute("id",t)},t.prototype._cursorVal=function(){return this.__clickable?this.__cursor||"pointer":""},t.prototype.set_scrollx=function(t){return this.el.scrollLeft!==t?this.el.scrollLeft=t:void 0},t.prototype.set_scrolly=function(t){return this.el.scrollTop!==t?this.el.scrollTop=t:void 0},t.prototype.set_cursor=function(t){return this.__cursor=t,this.setStyle("cursor",this._cursorVal(),!0)},t.prototype.set_visible=function(t){var e,i,n,s;return t?(e=null,i=this.el.$view,n=i.x,s=i.y):(e="hidden",n=s=-1e5),this.setStyle("visibility",e,!0),this.setStyle("marginLeft",n,!0),this.setStyle("marginTop",s,!0)},t.prototype.set_x=function(t){return this.el.$view.visible?this.setStyle("marginLeft",t,!0):void 0},t.prototype.set_y=function(t){return this.el.$view.visible?this.setStyle("marginTop",t,!0):void 0},t.prototype.set_clickable=function(t){return this.__clickable=t,this.__updatePointerEvents(),this.setStyle("cursor",this._cursorVal(),!0)},t.prototype.set_clip=function(t){return this.__clip=t,this.__updateOverflow()},t.prototype.set_scrollable=function(t){return this.__scrollable=t,this.__updateOverflow(),this.__updatePointerEvents(),t?$(this.el).on("scroll",this._handleScroll):$(this.el).off("scroll",this._handleScroll)},t.prototype.set_scrollbars=function(t){return this.__scrollbars=t,this._updateClass()},t.prototype._handleScroll=function(t){var e,i,n,s,r,o;return e=t.target,s=e.$view,s&&(r=e.scrollLeft,o=e.scrollTop,s.scrollx!==r&&s.setAttribute("scrollx",r),s.scrolly!==o&&s.setAttribute("scrolly",o),n=this._lastScrollEvent,i={scrollx:r,scrolly:o,scrollwidth:e.scrollWidth,scrollheight:e.scrollHeight},!n||n.scrollx!==i.scrollx||n.scrolly!==i.scrolly||n.scrollwidth!==i.scrollwidth||n.scrollheight!==i.scrollheight)?(s.sendEvent("scroll",i),this._lastScrollEvent=i):void 0},t.prototype.__updateOverflow=function(){return this.setStyle("overflow",this.__scrollable?"auto":this.__clip||this.__ellipsis?"hidden":"",!0)},t.prototype.__updatePointerEvents=function(){return this.setStyle("pointer-events",this.__clickable||this.__scrollable?"auto":"",!0)},t.prototype.destroy=function(){return this.el.parentNode.removeChild(this.el),this.input&&(this.input=this.input.$view=null),this.el=this.jqel=this.el.$view=null},t.prototype.setInnerHTML=function(t){return this.el.innerHTML=t},t.prototype.setText=function(t){var e,i,n,s,r;if(null!=t){for(r=this.el.childNodes,n=0,s=r.length;s>n;n++)e=r[n],e&&3===e.nodeType&&this.el.removeChild(e);return i=document.createTextNode(t),this.el.appendChild(i)}},t.prototype.getText=function(){var t,e;for(t=this.el.firstChild,e=[];t;)3===t.nodeType&&e.push(t.data.trim()),t=t.nextSibling;return e.join("")},t.prototype.getInnerHTML=function(){return this.el.innerHTML},t.prototype.value=function(t){return this.input?null!=t?this.input.value=t:this.input.value:void 0},t.prototype.handle=function(t){var e;return(e=t.target.$view)?e.sendEvent(t.type,e):void 0},t.prototype.createTextElement=function(){return this.css_baseclass="sprite sprite-text noselect",this._updateClass()},t.prototype.createInputtextElement=function(t,e,i,n){var s;return this.css_baseclass="sprite noselect",this._updateClass(),e?s=document.createElement("textarea"):(s=document.createElement("input"),s.setAttribute("type","text")),s.$init=!0,s.setAttribute("value",t),s.setAttribute("class","sprite-inputtext"),i&&this.setStyle("width",i,!0,s),n&&this.setStyle("height",n,!0,s),this.setStyle("color","inherit",!1,s),this.setStyle("background","inherit",!1,s),this.setStyle("font-variant","inherit",!1,s),this.setStyle("font-style","inherit",!1,s),this.setStyle("font-weight","inherit",!1,s),this.setStyle("font-size","inherit",!1,s),this.setStyle("font-family","inherit",!1,s),this.el.appendChild(s),s.$view=this.el.$view,$(s).on("focus blur",this.handle),this.input=s},t.prototype.getBounds=function(){return this.el.getBoundingClientRect()},t.prototype.getAbsolute=function(){var t;return null==this.jqel&&(this.jqel=$(this.el)),t=this.jqel.offset(),{x:t.left-window.pageXOffset,y:t.top-window.pageYOffset}},t.prototype.set_class=function(t){return null==t&&(t=""),this.__classname=t,this._updateClass()},t.prototype._updateClass=function(){var t;return t=this.css_baseclass,this.__classname&&(t+=" "+this.__classname),this.__scrollbars||(t+=" noscrollbar"),this.el.setAttribute("class",t)},t}(),k.camelcss&&(U=v.prototype.setStyle,C=function(t,e){return e.toUpperCase()},X=/-([\da-z])/gi,v.prototype.setStyle=function(t,e,i,n){return null==n&&(n=this.el),t.match(X)&&(t=t.replace(X,C)),U(t,e,i,n)}),F&&(O=["width","height","background-color","opacity","padding","transform","transform-style","transform-origin","z-index","perspective","cursor",k.prefix.css+"transform",k.prefix.css+"transform-style",k.prefix.css+"transform-origin"],G=v.prototype.setStyle,v.prototype.setStyle=function(t,i,n,s){return null==s&&(s=this.el),"$instanceattributes"!==t?(n||t in e||r.call(O,t)>=0||console.warn("Setting unknown CSS property "+t+" = "+i+" on ",this.el.$view,e,n),G(t,i,n,s)):void 0}),m=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,e),i.prototype.construct=function(t,e){var n,s,r,o;this.subviews=[],r={border:"positivenumber",borderstyle:"string",bottomborder:"positivenumber",bottompadding:"positivenumber","class":"string",clickable:"boolean",clip:"boolean",cursor:"string",height:"size",ignorelayout:"json",layouthint:"json",leftborder:"positivenumber",leftpadding:"positivenumber",opacity:"number",padding:"positivenumber",rightborder:"positivenumber",rightpadding:"positivenumber",rotation:"number",scrollable:"boolean",scrollbars:"boolean",scrollx:"number",scrolly:"number",skin:"string",topborder:"positivenumber",toppadding:"positivenumber",visible:"boolean",width:"size",x:"x",xanchor:"string",xscale:"number",y:"y",yanchor:"string",yscale:"number",z:"number",zanchor:"number",$tagname:"string",$textcontent:"string"},o=e.$types;for(n in o)s=o[n],r[n]=s;return this._declaredTypes=e.$types=r,this.__fullBorderPaddingWidth=this.__fullBorderPaddingHeight=0,this.xanchor=this.yanchor="center",this.cursor="pointer",this.bgcolor=this.bordercolor="transparent",this.borderstyle="solid",this.skin="",this.leftborder=this.rightborder=this.topborder=this.bottomborder=this.border=this.leftpadding=this.rightpadding=this.toppadding=this.bottompadding=this.padding=this.x=this.y=this.width=this.height=this.innerwidth=this.innerheight=this.boundsxdiff=this.boundsydiff=this.boundsx=this.boundsy=this.boundswidth=this.boundsheight=this.zanchor=this.scrollx=this.scrolly=0,this.opacity=1,this.clip=this.scrollable=this.clickable=this.isaligned=this.isvaligned=this.ignorelayout=this.scrollbars=!1,this.visible=!0,this._createSprite(t,e),i.__super__.construct.apply(this,arguments)},i.prototype.initialize=function(){return this.__autoLayoutwidth&&this.__autoLayoutwidth.setAttribute("locked",!1),this.__autoLayoutheight&&this.__autoLayoutheight.setAttribute("locked",!1),this.__updateBounds(),i.__super__.initialize.apply(this,arguments)},i.prototype._createSprite=function(t,e){return this.sprite=new v(t,this,e.$tagname)},i.prototype.destroy=function(t){return i.__super__.destroy.apply(this,arguments),t||this._removeFromParent("subviews"),this.sprite.destroy(),this.sprite=null},i.prototype.defaultSetAttributeBehavior=function(t,e){var n;return n=this[t],i.__super__.defaultSetAttributeBehavior.apply(this,arguments),e=this[t],n!==e?this.sprite.setAttribute(t,e):void 0},i.prototype.getBoundsRelativeToParent=function(){var t,e,i,n,s,r,o,a;return s=this.xanchor,a=this.yanchor,e=this.width,t=this.height,s="left"===s?0:"center"===s?e/2:"right"===s?e:Number(s),a="top"===a?0:"center"===a?t/2:"bottom"===a?t:Number(a),i=this.x,n=i+e,r=this.y,o=r+t,new b([i,r,n,r,n,o,i,o]).transformAroundOrigin(this.xscale,this.yscale,this.rotation,s+i,a+r).getBoundingBox()},i.prototype.__updateBounds=function(){var t,e,i,n,s,r,o;return this.__boundsAreDifferent?(t=this.getBoundsRelativeToParent(),i=t.width,e=t.height,n=t.x,r=t.y,s=this.x-n,o=this.y-r):(n=this.x,r=this.y,s=o=0,i=this.width,e=this.height),S(this.boundsx,n)||this.setAndFire("boundsx",n),S(this.boundsy,r)||this.setAndFire("boundsy",r),S(this.boundswidth,i)||this.setAndFire("boundswidth",i),S(this.boundsheight,e)||this.setAndFire("boundsheight",e),S(this.boundsxdiff,s)||this.setAndFire("boundsxdiff",s),S(this.boundsydiff,o)?void 0:this.setAndFire("boundsydiff",o)},i.prototype.__setupAlignConstraint=function(t,e){var i,n,s,r,o,a,u,l,h,d,p;if(a="__alignFunc"+t,("string"==typeof e||this[a])&&(d=this.parent,d instanceof g&&("x"===t?(u=!0,n="innerwidth",s="boundsxdiff",r="boundswidth",i="isaligned"):(u=!1,n="innerheight",s="boundsydiff",r="boundsheight",i="isvaligned"),h=this[a],h&&(this.stopListening(d,n,h),this.stopListening(this,s,h),this.stopListening(this,r,h),delete this[a],this[i]&&this.setAndFire(i,!1)),"string"==typeof e))){if(l=e.toLowerCase(),p=this,"begin"===l||u&&"left"===l||!u&&"top"===l)o=this[a]=function(){var e;return e=p[s],p[t]!==e?(p.__noSpecialValueHandling=!0,p.setAttribute(t,e)):void 0},o.autoOk=!0;else if("middle"===l||"center"===l)o=this[a]=function(){return p.__noSpecialValueHandling=!0,p.setAttribute(t,(d[n]-p[r])/2+p[s])},this.listenTo(d,n,o),this.listenTo(this,r,o);else if("end"===l||u&&"right"===l||!u&&"bottom"===l)o=this[a]=function(){return p.__noSpecialValueHandling=!0,p.setAttribute(t,d[n]-p[r]+p[s])},this.listenTo(d,n,o),this.listenTo(this,r,o);else if("none"===l)return!0;return o?(this.listenTo(this,s,o),o.call(),this[i]||this.setAndFire(i,!0),!0):void 0}},i.prototype.__setupAutoConstraint=function(e,i,n){var s,r;return s="__autoLayout"+e,"auto"===i||this[s]?(r=this[s],r&&(r.destroy(),delete this[s]),"auto"===i?(this[s]=new t(null,{parent:this,axis:n,locked:this.inited?"false":"true"}),this.inited||(this.__noSpecialValueHandling=!0,this.setAttribute(e,0)),!0):void 0):void 0},i.prototype.__setupPercentConstraint=function(t,e,i){var n,s,r,o,a,u;return s="__percentFunc"+t,"string"==typeof e||this[s]?(r=this[s],o=this.parent,o instanceof g||(o=dr.window,i=i.substring(5)),r&&(this.stopListening(o,i,r),delete this[s]),I.test(e)?(u=this,a=parseInt(e)/100,n=this[s]=function(){return u.__noSpecialValueHandling=!0,u.setAttribute(t,o[i]*a)},this.listenTo(o,i,n),n.call(),!0):void 0):void 0},i.prototype.set_parent=function(t){var e;return e=i.__super__.set_parent.apply(this,arguments),t instanceof i&&(t.subviews.push(this),t.sendEvent("subviews",this),t=t.sprite),this.sprite.set_parent(t),e},i.prototype.set_id=function(t){var e;return e=i.__super__.set_id.apply(this,arguments),this.sprite.set_id(t),e},i.prototype.set_class=function(t){return this["class"]!==t&&(this.sprite.set_class(t),this.setAndFire("class",t)),D},i.prototype.set_clip=function(t){return this.clip!==t&&(this.sprite.set_clip(t),this.setAndFire("clip",t)),D},i.prototype.set_scrollable=function(t){return this.scrollable!==t&&(this.sprite.set_scrollable(t),this.setAndFire("scrollable",t)),D},i.prototype.set_scrollbars=function(t){return this.scrollbars!==t&&(this.sprite.set_scrollbars(t),this.setAndFire("scrollbars",t)),D},i.prototype.set_scrollx=function(t){return t=isNaN(t)?0:Math.max(0,Math.min(this.sprite.el.scrollWidth-this.width+this.leftborder+this.rightborder,t)),this.scrollx!==t&&(this.sprite.set_scrollx(t),this.setAndFire("scrollx",t)),D},i.prototype.set_scrolly=function(t){return t=isNaN(t)?0:Math.max(0,Math.min(this.sprite.el.scrollHeight-this.height+this.topborder+this.bottomborder,t)),this.scrolly!==t&&(this.sprite.set_scrolly(t),this.setAndFire("scrolly",t)),D},i.prototype.set_visible=function(t){return this.visible!==t&&(this.sprite.set_visible(t),this.setAndFire("visible",t)),D},i.prototype.set_bgcolor=function(t){return this.bgcolor!==t&&(this.sprite.setAttribute("bgcolor",t),this.setAndFire("bgcolor",t)),D},i.prototype.set_x=function(t){if(this.__noSpecialValueHandling)this.__noSpecialValueHandling=!1;else{if(this.__setupPercentConstraint("x",t,"innerwidth"))return D;if(this.__setupAlignConstraint("x",t))return D}return this.x!==t&&(this.sprite.set_x(t),this.__boundsAreDifferent&&t-this.boundsxdiff!==this.boundsx&&this.sendEvent("boundsx",this.boundsx=t-this.boundsxdiff),this.setAndFire("x",t),this.inited&&this.__updateBounds()),D},i.prototype.set_y=function(t){if(this.__noSpecialValueHandling)this.__noSpecialValueHandling=!1;else{if(this.__setupPercentConstraint("y",t,"innerheight"))return D;if(this.__setupAlignConstraint("y",t))return D}return this.y!==t&&(this.sprite.set_y(t),this.__boundsAreDifferent&&t-this.boundsydiff!==this.boundsy&&this.sendEvent("boundsy",this.boundsy=t-this.boundsydiff),this.setAndFire("y",t),this.inited&&this.__updateBounds()),D},i.prototype.set_width=function(t,e){if(this.__noSpecialValueHandling)this.__noSpecialValueHandling=!1;else{if(this.__setupPercentConstraint("width",t,"innerwidth"))return D;if(this.__setupAutoConstraint("width",t,"x"))return D}return t=Math.max(t,this.__fullBorderPaddingWidth),this.width!==t&&(e||this.sprite.setAttribute("width",t),this.setAndFire("innerwidth",t-this.__fullBorderPaddingWidth),this.setAndFire("width",t),this.inited&&this.__updateBounds()),D},i.prototype.set_height=function(t,e){if(this.__noSpecialValueHandling)this.__noSpecialValueHandling=!1;else{if(this.__setupPercentConstraint("height",t,"innerheight"))return D;if(this.__setupAutoConstraint("height",t,"y"))return D}return t=Math.max(t,this.__fullBorderPaddingHeight),this.height!==t&&(e||this.sprite.setAttribute("height",t),this.setAndFire("innerheight",t-this.__fullBorderPaddingHeight),this.setAndFire("height",t),this.inited&&this.__updateBounds()),D
},i.prototype.set_border=function(t){return this.__lockBPRecalc=!0,this.setAttribute("topborder",t),this.setAttribute("bottomborder",t),this.setAttribute("leftborder",t),this.setAttribute("rightborder",t),this.__lockBPRecalc=!1,this.setAndFire("border",t),this.__updateInnerWidth(),this.__updateInnerHeight(),D},i.prototype.set_topborder=function(t){return this.sprite.setAttribute("topborder",t),this.setAndFire("topborder",t),this.__lockBPRecalc||(this.__updateBorder(),this.__updateInnerHeight()),D},i.prototype.set_bottomborder=function(t){return this.sprite.setAttribute("bottomborder",t),this.setAndFire("bottomborder",t),this.__lockBPRecalc||(this.__updateBorder(),this.__updateInnerHeight()),D},i.prototype.set_leftborder=function(t){return this.sprite.setAttribute("leftborder",t),this.setAndFire("leftborder",t),this.__lockBPRecalc||(this.__updateBorder(),this.__updateInnerWidth()),D},i.prototype.set_rightborder=function(t){return this.sprite.setAttribute("rightborder",t),this.setAndFire("rightborder",t),this.__lockBPRecalc||(this.__updateBorder(),this.__updateInnerWidth()),D},i.prototype.__updateBorder=function(){return Q=this.topborder,this.bottomborder===Q&&this.leftborder===Q&&this.rightborder===Q?this.setAndFire("border",Q):null!=this.border?this.setAndFire("border",void 0):void 0},i.prototype.set_padding=function(t){return this.__lockBPRecalc=!0,this.setAttribute("toppadding",t),this.setAttribute("bottompadding",t),this.setAttribute("leftpadding",t),this.setAttribute("rightpadding",t),this.__lockBPRecalc=!1,this.setAndFire("padding",t),this.__updateInnerWidth(),this.__updateInnerHeight(),D},i.prototype.set_toppadding=function(t){return this.sprite.setAttribute("toppadding",t),this.setAndFire("toppadding",t),this.__lockBPRecalc||(this.__updatePadding(),this.__updateInnerHeight()),D},i.prototype.set_bottompadding=function(t){return this.sprite.setAttribute("bottompadding",t),this.setAndFire("bottompadding",t),this.__lockBPRecalc||(this.__updatePadding(),this.__updateInnerHeight()),D},i.prototype.set_leftpadding=function(t){return this.sprite.setAttribute("leftpadding",t),this.setAndFire("leftpadding",t),this.__lockBPRecalc||(this.__updatePadding(),this.__updateInnerWidth()),D},i.prototype.set_rightpadding=function(t){return this.sprite.setAttribute("rightpadding",t),this.setAndFire("rightpadding",t),this.__lockBPRecalc||(this.__updatePadding(),this.__updateInnerWidth()),D},i.prototype.__updatePadding=function(){return Q=this.toppadding,this.bottompadding===Q&&this.leftpadding===Q&&this.rightpadding===Q?this.setAndFire("padding",Q):null!=this.padding?this.setAndFire("padding",void 0):void 0},i.prototype.__updateInnerWidth=function(){var t;return this.__fullBorderPaddingWidth=t=this.leftborder+this.rightborder+this.leftpadding+this.rightpadding,t>this.width&&(this.__noSpecialValueHandling=!0,this.setAttribute("width",t,!0)),this.setAndFire("innerwidth",this.width-t)},i.prototype.__updateInnerHeight=function(){var t;return this.__fullBorderPaddingHeight=t=this.topborder+this.bottomborder+this.toppadding+this.bottompadding,t>this.height&&(this.__noSpecialValueHandling=!0,this.setAttribute("height",t,!0)),this.setAndFire("innerheight",this.height-t)},i.prototype.set_clickable=function(t){return this.clickable!==t&&(this.sprite.set_clickable(t),this.setAndFire("clickable",t)),D},i.prototype.set_cursor=function(t){return this.cursor!==t&&(this.sprite.set_cursor(t),this.setAndFire("cursor",t)),D},i.prototype.__updateTransform=function(){var t,e,i,n,s;return t="",i=this.xscale,null==this.xscale&&(i=this.xscale=1),s=this.yscale,null==this.yscale&&(s=this.yscale=1),(1!==i||1!==s)&&(t+="scale3d("+i+","+s+",1.0)"),this.rotation||(this.rotation=0),this.rotation%360!==0&&(t+=" rotate3d(0,0,1.0,"+this.rotation+"deg)"),this.__boundsAreDifferent=""!==t,this.z||(this.z=0),0!==this.z&&(t+=" translate3d(0,0,"+this.z+"px)",this.parent.sprite.setAttribute("transform-style","preserve-3d")),""!==t&&(e=this.xanchor,"left"!==e&&"right"!==e&&"center"!==e&&(e+="px"),n=this.yanchor,"top"!==n&&"bottom"!==n&&"center"!==n&&(n+="px"),this.sprite.setAttribute("transform-origin",e+" "+n+" "+this.zanchor+"px")),this.sprite.setAttribute("transform",t)},i.prototype.set_perspective=function(t){return"0"===t?"none":t+"px"},i.prototype.set_xscale=function(t){return t!==this.xscale&&(this.setAndFire("xscale",t),this.__updateTransform(),this.inited&&this.__updateBounds()),D},i.prototype.set_yscale=function(t){return t!==this.yscale&&(this.setAndFire("yscale",t),this.__updateTransform(),this.inited&&this.__updateBounds()),D},i.prototype.set_rotation=function(t){return t!==this.rotation&&(this.setAndFire("rotation",t),this.__updateTransform(),this.inited&&this.__updateBounds()),D},i.prototype.set_z=function(t){return t!==this.z&&(this.sprite.setAttribute("z",t),this.setAndFire("z",t),this.__updateTransform()),D},i.prototype.set_xanchor=function(t){return(null==t||""===t||"undefined"===t)&&(t="center"),t!==this.xanchor&&(this.setAndFire("xanchor",t),this.__updateTransform(),this.inited&&this.__updateBounds()),D},i.prototype.set_yanchor=function(t){return(null==t||""===t||"undefined"===t)&&(t="center"),t!==this.yanchor&&(this.setAndFire("yanchor",t),this.__updateTransform(),this.inited&&this.__updateBounds()),D},i.prototype.set_zanchor=function(t){return(null==t||""===t)&&(t=0),t!==this.zanchor&&(this.setAndFire("zanchor",t),this.__updateTransform()),D},i.prototype.set_skin=function(t){return t!==this.skin&&(this.skin=t,this.reskin(),this.setAndFire("skin",t)),D},i.prototype.attachSkinListener=function(){return this.$skinlistner?void 0:(this.$skinlistner=!0,this.listenTo(this,"subviewAdded",function(t){return t.attachSkinListener(),t.reskin()}))},i.prototype.reskin=function(){var t,e,i,n,s,r;if(this.attachSkinListener(),!window.dr.skins)return void console.log("<skin> hasn't been initialized yet",this);if(this.skin){for(i=this.skin.split(/[^A-Za-z0-9_-]+/),r=[],n=0,s=i.length;s>n;n++)e=i[n],r.push((t=window.dr.skins[e])?t.applyTo(this):console.log("Cannot apply skin:",e));return r}return this.parent&&this.parent.reskin?this.parent.reskin():void 0},i.prototype.moveToFront=function(){var t,e,i,n;for(n=this.parent.subviews,e=0,i=n.length;i>e;e++)t=n[e],t.z||t.setAttribute("z",0),this.z<=t.z&&(this.z=t.z+1);return this.__updateTransform()},i.prototype.moveToBack=function(){var t,e,i,n;for(n=this.parent.subviews,e=0,i=n.length;i>e;e++)t=n[e],t.z||t.setAttribute("z",0),this.z>=t.z&&(this.z=t.z-1);return this.__updateTransform()},i.prototype.moveInFrontOf=function(t){return t?(t.z||t.setAttribute("z",0),this.z=t.z+1,this.__updateTransform()):void 0},i.prototype.moveBehind=function(t){return t?(t.z||t.setAttribute("z",0),this.z=t.z-1,this.__updateTransform()):void 0},i.prototype.doSubnodeAdded=function(t){return t instanceof i?(t.__updateBounds(),this.sendEvent("subviewAdded",t),this.doSubviewAdded(t)):t instanceof p?this.doLayoutAdded(t):void 0},i.prototype.doSubnodeRemoved=function(t){return t instanceof i?(this.sendEvent("subviewRemoved",t),this.doSubviewRemoved(t)):t instanceof p?this.doLayoutRemoved(t):void 0},i.prototype.doSubviewAdded=function(){},i.prototype.doSubviewRemoved=function(){},i.prototype.doLayoutAdded=function(){},i.prototype.doLayoutRemoved=function(){},i.prototype.getLayoutHint=function(t,e){var i,n;if(n=this.layouthint){if(i=n[t+"/"+e],null!=i)return i;if(i=n[e],null!=i)return i;if(i=n["*/"+e],null!=i)return i}},i.prototype.getAbsolute=function(){return this.sprite.getAbsolute()},i}(g),ee=[],Y=function(t){var e,i;return ee=ee.concat(t),e=t.join("\n"),i=document.createElement("pre"),i.setAttribute("class","warnings"),i.textContent=e,document.body.insertBefore(i,document.body.firstChild),console.error(e)},K=["handler","method","attribute","setter","include"],j=/^on(.+)/,Z="-",L=function(){var t,e,s,o,a,l,h,d,c,f,b,v,_,w;return a=function(t){var e,i,n,s;for(e={},n=0,s=t.length;s>n;n++)i=t[n],e[i.name]=i.value;return e},_=function(t){var e;return e=document.createEvent("Event"),e.initEvent("dreeminit",!0,!0),window.dispatchEvent(e),$(t).addClass("dreeminited")},f=function(t){return N=!0,t.style.visibility="hidden",o(t,function(){return t.style.visibility=null,c(t),ie(),_(t)})},l=function(t){var e,i,n,s,r;for(s=t.childNodes,r=[],i=0,n=s.length;n>i;i++)e=s[i],1===e.nodeType&&r.push(e);return r},o=function(e,s){var o,a,l,h,d,c,f,b,v,_,w,x,k,A,S,T,E;return _=$(e),b={},S=[],T=!1,a=[],A=function(t,e,i){var n,s;if(!(t in b))return b[t]=!0,a.push(t),T?(S.push(t,i),t):(n=function(t,e,i){var n;return null==i&&(i="failed to load scriptinclude "+t),T=t,n=document.createElement("script"),n.type="text/javascript",$("head").append(n),n.onload=e,n.onerror=function(t){return console.error(i,t),e()},n.src=t},s=function(){return T=!1,0===S.length?e():n(S.shift(),s,S.shift())},n(t,s,i))},v={},d=[],l={},w=function(t,e){var i;if(!(t in l))return l[t]=e,a.push(t),i=$.get(t),i.url=t,i.el=e,d.push(i)},k=function(t,e){var i,n,s,r,o;if(null==e&&(e={}),t.attributes["with"]&&null!=t.attributes["with"].value){for(r=t.attributes["with"].value.split(","),o=[],n=0,s=r.length;s>n;n++)i=r[n],o.push(e[i.trim()]=t);return o}},f=function(e){var i,n,s,o,a,u,h,d;for(null==e&&(e={}),u=_.find("*"),o=0,a=u.length;a>o;o++)i=u[o],n=i.localName,"class"===n?(i.attributes["extends"]&&(e[i.attributes["extends"].value]=i),k(i,e),v[null!=(h=i.attributes.name)?h.value:void 0]=!0):"replicator"===n?(e[n]=i,e[i.attributes.classname.value]=i,k(i,e)):(d=i.parentNode.localName,r.call(K,d)<0&&(e[n]=i,k(i,e)));s={};for(n in e)i=e[n],n in dr||n in l||r.call(K,n)>=0||n in v||t[n]||(s[n]=i);return s},c=function(t){var e,i,n,s,r;for(null==t&&(t={}),r=_.find("include"),n=0,s=r.length;s>n;n++)e=r[n],i=e.attributes.href.value,e.parentNode.removeChild(e),t[i]=e;return t},x=function(t){var e,s,r;l.skin||(l.skin=!0,w("/classes/skin.dre")),r=c();for(s in r)e=r[s],w(s,e);return $.when.apply($,d).done(function(){var r,o,a,h,b,v,k,S,T,E;for(r=1<=arguments.length?i.call(arguments,0):[],1===d.length&&(r=[r]),d=[],h=/<[\/]*library>/gi,k=0,S=r.length;S>k;k++)v=r[k],a=v[0].replace(h,""),_.prepend(a);T=f();for(b in T)e=T[b],l[b]=!0,b&&w("/classes/"+b.split(Z).join("/")+".dre",e);$.when.apply($,d).done(function(){var r,o,a,l,h;for(r=1<=arguments.length?i.call(arguments,0):[],1===d.length&&(r=[r]),d=[],l=0,h=r.length;h>l;l++)v=r[l],_.prepend(v[0]),_.contents().each(function(){return this.nodeType===n?$(this).remove():void 0});return o=f(c()),Object.keys(o).length>0?void x(t):(a="/lib/one_base.js",$.ajax({dataType:"script",cache:!0,url:a}).done(function(){var i,n,r,o;for(ONE.base_.call(u.prototype),u.prototype.enumfalse(u.prototype.keys()),g.prototype.enumfalse(g.prototype.keys()),m.prototype.enumfalse(m.prototype.keys()),p.prototype.enumfalse(p.prototype.keys()),y.prototype.enumfalse(y.prototype.keys()),A("/lib/animator.js",t,"Missing /lib/animator.js"),r=_.find("[scriptincludes]"),o=[],i=0,n=r.length;n>i;i++)e=r[i],o.push(function(){var i,n,r,o,a;for(r=e.attributes.scriptincludes.value.split(","),a=[],i=0,n=r.length;n>i;i++)s=r[i],a.push(A(s.trim(),t,null!=(o=e.attributes.scriptincludeserror)?o.value.toString():void 0));return a}());return o}).fail(function(){return console.warn("failed to load "+a)}))}).fail(function(){var t,e,n;for(t=1<=arguments.length?i.call(arguments,0):[],1===t.length&&(t=[t]),e=0,n=t.length;n>e;e++)v=t[e],Y(["failed to load "+v.url+" for element "+v.el.outerHTML])}),E=[];for(o in l)E.push(l[o]=!0);return E}).fail(function(){var t,e,n,s;for(t=1<=arguments.length?i.call(arguments,0):[],1===t.length&&(t=[t]),n=0,s=t.length;s>n;n++)e=t[n],Y(["failed to load "+e.url+" for element "+e.el.outerHTML])})},o=["/primus/primus.io.js"],h=function(){var t;return a.push(window.location.pathname),a.push("/core/layout.coffee"),t=a.filter(function(t){return r.call(o,t)<0?!0:void 0}),$.ajax({url:"/watchfile/",datatype:"text",data:{url:t},success:function(e){return r.call(t,e)>=0?window.location.reload():void 0}}).done(function(){return h()})},E=function(){return $.ajax({url:"/validate/",data:{url:window.location.pathname},success:function(t){return t.length&&Y(t),h()},error:function(){return console.warn("Validation requires the Teem server")}}).always(s)},x(Q?s:E)},t={a:!0,abbr:!0,address:!0,area:!0,article:!0,aside:!0,audio:!0,b:!0,base:!0,bdi:!0,bdo:!0,blockquote:!0,body:!0,br:!0,button:!0,canvas:!0,caption:!0,cite:!0,code:!0,col:!0,colgroup:!0,command:!0,datalist:!0,dd:!0,del:!0,details:!0,dfn:!0,div:!0,dl:!0,dt:!0,em:!0,embed:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,head:!0,header:!0,hgroup:!0,hr:!0,html:!0,i:!0,iframe:!0,img:!0,image:!0,input:!0,ins:!0,kbd:!0,keygen:!0,label:!0,legend:!0,li:!0,link:!0,map:!0,mark:!0,menu:!0,meta:!0,meter:!0,nav:!0,noscript:!0,object:!0,ol:!0,optgroup:!0,option:!0,output:!0,p:!0,param:!0,pre:!0,progress:!0,q:!0,rp:!0,rt:!0,ruby:!0,s:!0,samp:!0,script:!0,section:!0,select:!0,small:!0,source:!0,span:!0,strong:!0,style:!0,sub:!0,summary:!0,sup:!0,table:!0,tbody:!0,td:!0,textarea:!0,tfoot:!0,th:!0,thead:!0,time:!0,title:!0,tr:!0,track:!0,u:!0,ul:!0,"var":!0,video:!0,wbr:!0},v={"class":{name:1},method:{name:1},setter:{name:1},handler:{event:1},attribute:{name:1,type:1,value:1},dataset:{name:1},replicator:{classname:1}},e=function(t,e,i,n){var s,r;if(t in v)for(s in v[t])s in e||(r=""+t+"."+s+" must be defined on "+i.outerHTML,n&&(r+=" inside "+n.outerHTML),Y([r]));return r},c=function(i,n){var s,o,u,l,h,d,p,f,g,b,v,_,y,m,w,k;if(!i.$init){if(i.$init=!0,_=i.localName,!_ in dr)return void(t[_]||console.warn("could not find class for tag",_,i));if(t[_])return void("input"!==_&&console.warn("refusing to create a class that would overwrite the builtin tag",_));for(o=a(i.attributes),e(_,o,i),o.$tagname=_,y=0,w=W.length;w>y;y++)d=W[y],p="on"+d,p in o&&(o.clickable!==!1&&(o.clickable=!0),i.removeAttribute(p));for(s in o)j.test(s)&&i.removeAttribute(s);if(null==n&&(n=i.parentNode),null!=n&&(o.parent=n),b=_.lastIndexOf("state"),g=b>-1&&b===_.length-5,f="class"===_,f||g||L.processSpecialTags(i,o,o.type),h=L.getChildElements(i),o.$skiponinit=v=h.length>0,"function"!=typeof dr[_])return void Y(["Unrecognized class "+_+" "+i.outerHTML]);if(n=new dr[_](i,o,!0),h.length>0&&!f&&!g){if(!dr[_].skipinitchildren)for(h=function(){var t,e,n,s,o;for(n=L.getChildElements(i),o=[],t=0,e=n.length;e>t;t++)l=n[t],s=l.localName,r.call(K,s)<0&&o.push(l);return o}(),m=0,k=h.length;k>m;m++)l=h[m],c(l,n);n.inited||(u=function(){n.inited||(n._bindHandlers(!0),n.initialize())},x(u))}}},w=function(){var t,e,i,n,s,r;return s=document.createElement("style"),s.type="text/css",i=["position:absolute","pointer-events:none","padding:0","margin:0","box-sizing:border-box","border-color:transparent","border-style:solid","border-width:0"],n=["white-space:nowrap","padding:0","margin:0","text-decoration:none","font-family:mission-gothic, 'Helvetica Neue', Helvetica, Arial, sans-serif","font-size:20px"],e=["border:none","outline:none","background-color:transparent","resize:none"],t=["-webkit-touch-callout:none","-webkit-user-select:none","-khtml-user-select:none","-moz-user-select:none","-ms-user-select:none","user-select:none"],r=["font-size:14px","background-color:pink","margin:0"],s.innerHTML=".sprite{"+i.join(";")+"}.sprite-text{"+n.join(";")+"}.sprite-inputtext{"+e.join(";")+"}.noselect{"+t.join(";")+"}.warnings{"+r.join(";")+"}.noscrollbar::-webkit-scrollbar{display:none;}.hidden{display:none}method,handler,setter,class,node,dataset{display:none}",document.getElementsByTagName("head")[0].appendChild(s)},d=function(t){var e,i,n;for(null==t&&(t=$("view").not("view view")),i=0,n=t.length;n>i;i++)e=t[i],f(e)},h=function(t){var e,i,n,s,r,o;for(i=document.createElement("div"),i.innerHTML=t,n="",o=i.childNodes,s=0,r=o.length;r>s;s++){if(e=o[s],null==e.nodeValue||3!==e.nodeType&&8!==e.nodeType)return;n+=e.nodeValue}return n},b=function(t,i,n){var s,o,u,l,d,p,c,f,g,b,v,_,y,m;for(null==i.$types&&(i.$types={}),null==i.$methods&&(i.$methods={}),null==i.$handlers&&(i.$handlers=[]),l=function(){var e,i,n,s,o;for(n=L.getChildElements(t),o=[],e=0,i=n.length;i>e;e++)u=n[e],s=u.localName,r.call(K,s)>=0&&o.push(u);return o}(),v=0,_=l.length;_>v;v++)switch(u=l[v],o=a(u.attributes),f=u.localName,s=(null!=(y=o.args)?y:"").split(),c=h(u.innerHTML),null==c&&console.warn("Invalid tag",p,u),g=null!=(m=o.type)?m:n,p=o.name,e(f,o,u,t),f){case"handler":d={name:p,ev:o.event,script:T.transform(c,g),args:s,reference:o.reference,method:o.method},i.$handlers.push(d);break;case"method":case"setter":"setter"===f&&(p="set_"+p.toLowerCase()),null==(b=i.$methods)[p]&&(b[p]=[]),i.$methods[p].push({method:T.transform(c,g),args:s,allocation:o.allocation});break;case"attribute":p=p.toLowerCase(),i[p]=o.value,i.$types[p]=o.type}return l},s={initAllElements:d,initElement:c,processSpecialTags:b,writeCSS:w,getChildElements:l}}(),y=function(t){function e(t,e){var i,n,s,o,a,u,l,h,d,p,c,f,g,b,v,_;for(null==e&&(e={}),this.skipattributes=["parent","types","applyattributes","applied","skipattributes","stateattributes","subnodes"],this.subnodes=[],this.stateattributes=e,this.applyattributes={},this.applied=!1,n=e.type,l=L.processSpecialTags(t,e,n),u=t.innerHTML.trim(),c=0,g=l.length;g>c;c++)i=l[c],i.parentNode.removeChild(i);this.instancebody=t.innerHTML.trim(),u&&(t.innerHTML=u),this.types=null!=(v=e.$types)?v:{},this.setAttribute("parent",e.parent),null==(d=this.parent).states&&(d.states=[]),null==(p=this.parent.states).origmethods&&(p.origmethods={}),this.parent.states.push(this),this.parent.sendEvent("states",this.parent.states),this.statemethods=e.$methods;for(a in e)h=e[a],r.call(this.skipattributes,a)>=0||"$"===a.charAt(0)||("name"!==a&&(this.applyattributes[a]=h),this.setAttribute(a,h));for(e.applied&&this.bindAttribute("applied",e.applied,"state"),_=e.$handlers,f=0,b=_.length;b>f;f++)o=_[f],"onapplied"===o.ev&&(this.installHandlers([o],"state",this),this._bindHandlers());s=function(t){return function(){return t.constraints&&t._bindConstraints(),t.events&&t.skipattributes.push("events"),t.enumfalse(t.skipattributes)}}(this),x(s),t&&(t.$view=this),this.children=[],this.initialize(!0)}return s(e,t),e.prototype.set_applied=function(t){var e,i,n;if(this.parent&&this.applied!==t){i=this.parent.states.origmethods;for(e in i)this.parent[e]=i[e];t?this._apply():this._remove();for(e in this.applyattributes)n=this.parent[e],delete this.parent[e],this.parent.setAttribute(e,n,!0)}return t},e.prototype._apply=function(){var t,e,i,n,s,o,a,u,l,h,d,p,c,f,g,b;if(!this.applied){this.parent.learn(this),o=this.parent.states.origmethods;for(s in this.statemethods)s in this.parent&&r.call(o,s)<0&&(o[s]=this.parent[s]);for(b=this.parent.states,h=0,c=b.length;c>h;h++)u=b[h],(u.applied||u===this)&&this.parent.installMethods(u.statemethods,this.parent.$tagname,this.parent,this.parent);if(this.instancebody){for(a=this.parent.sprite.el,e=L.getChildElements(a),d=0,f=e.length;f>d;d++)i=e[d],i.$view&&(i.$view=null);for(a.innerHTML+=this.instancebody,t=L.getChildElements(a),n=p=0,g=t.length;g>p;n=++p)i=t[n],n<e.length?(l=this.parent.subnodes[n],(null!=l?l.sprite:void 0)&&(l.sprite.el=i),i.$view=l):(L.initElement(i,this.parent),this.children.push(i.$view))}return this.stateattributes.$handlers?(this.parent.installHandlers(this.stateattributes.$handlers,this.parent.$tagname,this.parent),this.parent._bindHandlers()):void 0}},e.prototype._remove=function(){var t,e,i,n,s;if(this.applied){for(this.parent.forget(this);t=this.children.pop();)t.destroy();for(s=this.parent.states,i=0,n=s.length;n>i;i++)e=s[i],e.applied&&e!==this&&this.parent.installMethods(e.statemethods,this.parent.$tagname,this.parent,this.parent);return this.stateattributes.$handlers?this.parent.removeHandlers(this.stateattributes.$handlers,this.parent.$tagname,this.parent):void 0}},e}(g),a=function(){function t(t,e){var i,s,o,a,u,l,h,d,p,c,f,g,b,v,_,y,m,w,k,S,$,T,E,F;null==e&&(e={}),f=e.name?e.name.toLowerCase():e.name,a=null!=e["extends"]?e["extends"]:e["extends"]="view",s=e.type,m="false"===e.initchildren,delete e.initchildren;for(h in P)delete e[h];for(F=t.childNodes,w=0,$=F.length;$>w;w++)i=F[w],null!=i&&i.nodeType===n&&i.parentNode.removeChild(i);for(y=L.processSpecialTags(t,e,s),b=t.innerHTML.trim(),k=0,T=y.length;T>k;k++)i=y[k],i.parentNode.removeChild(i);if(u=L.getChildElements(t).length>0,d=t.innerHTML.trim(),b&&(t.innerHTML=b),f in dr&&console.warn("overwriting class",f),dr[f]=p=function(t,n,s,o){var l,h,p,c,g,b,v,_,y;if(l=A(e),ne(n,l),null==l.$instanceattributes&&(l.$instanceattributes=n),!(a in dr))return void console.warn("could not find class for tag",a);if("class"!==l.$tagname&&l.$tagname||(l.$tagname=f),l.$skiponinit=!0,l.$deferbindings=u,p=new dr[a](t,l,!0,!0),g=null!=(y=p.sprite)?y.el:void 0,t&&(g||t.setAttribute("class","hidden")),g&&(d&&(b=g.innerHTML.trim(),g.innerHTML=b?d+b:d),!o&&(h=function(){var t,e,n,s,o;for(n=L.getChildElements(g),o=[],t=0,e=n.length;e>t;t++)i=n[t],s=i.localName,r.call(K,s)<0&&o.push(i);return o}(),!m)))for(v=0,_=h.length;_>v;v++)i=h[v],L.initElement(i,p);return o||(c=function(){return p.inited?void 0:(p._bindHandlers(!0),p.initialize())},s?x(c):c()),p},f&&(_=f.split(Z),c=_.length,c>1))for(o=dr,l=S=0,E=_.length;E>S;l=++S)v=_[l],l===c-1?o[v]=p:(g=o[v],g||(o[v]=g={}),o=g);p.skipinitchildren=m,p.classattributes=e}return t}(),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.construct=function(t,i){var n,s,r,o,a,u;if(null==i.$types&&(i.$types={}),i.$types.locked="boolean",null!=i.locked&&(n="true"===i.locked?!0:!1),this.locked=!0,this.subviews=[],e.__super__.construct.apply(this,arguments),this.listenTo(this.parent,"subviewAdded",this.addSubview.bind(this)),this.listenTo(this.parent,"subviewRemoved",this.removeSubview.bind(this)),this.listenTo(this.parent,"init",this.update.bind(this)),null==(o=this.parent).layouts&&(o.layouts=[]),this.parent.layouts.push(this),this.parent.sendEvent("layouts",this.parent.layouts),r=this.parent.subviews,r&&this.parent.inited)for(a=0,u=r.length;u>a;a++)s=r[a],this.addSubview(s);return this.locked=null!=n?n:!1,this.update()},e.prototype.destroy=function(t){return this.locked=!0,e.__super__.destroy.apply(this,arguments),t?void 0:this._removeFromParent("layouts")},e.prototype.addSubview=function(t){var e,i;return i=this,e=this.__ignoreFunc=function(){return-1===i.__removeSubview(this)?i.__addSubview(this):void 0},this.startMonitoringSubviewForIgnore(t,e),this.__addSubview(t)},e.prototype.__addSubview=function(t){return this.ignore(t)?void 0:(this.subviews.push(t),this.startMonitoringSubview(t),this.locked?void 0:this.update())},e.prototype.removeSubview=function(t){return this.stopMonitoringSubviewForIgnore(t,this.__ignoreFunc),this.ignore(t)?-1:this.__removeSubview(t)},e.prototype.__removeSubview=function(t){var e;return e=this.subviews.indexOf(t),-1!==e&&(this.stopMonitoringSubview(t),this.subviews.splice(e,1),this.locked||this.update()),e},e.prototype.startMonitoringSubviewForIgnore=function(t,e){return this.listenTo(t,"ignorelayout",e)},e.prototype.stopMonitoringSubviewForIgnore=function(t,e){return this.stopListening(t,"ignorelayout",e)},e.prototype.ignore=function(t){var e,i,n;return e=t.ignorelayout,"object"==typeof e?(i=this.name,i?(n=e[i],null!=n?n:e["*"]):e["*"]):e},e.prototype.startMonitoringSubview=function(){},e.prototype.startMonitoringAllSubviews=function(){var t,e,i;for(e=this.subviews,t=e.length,i=[];t;)i.push(this.startMonitoringSubview(e[--t]));return i},e.prototype.stopMonitoringSubview=function(){},e.prototype.stopMonitoringAllSubviews=function(){var t,e,i;for(e=this.subviews,t=e.length,i=[];t;)i.push(this.stopMonitoringSubview(e[--t]));return i},e.prototype.canUpdate=function(){return!this.locked&&this.parent.inited},e.prototype.update=function(){},e.prototype.set_locked=function(t){return this.locked!==t&&t===!1&&(this.locked=!1,this.update()),t},e}(g),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.startMonitoringSubview=function(t){var e;return e=this.update.bind(this),"x"===this.axis?(this.listenTo(t,"x",e),this.listenTo(t,"width",e),this.listenTo(t,"boundsx",e),this.listenTo(t,"boundswidth",e)):(this.listenTo(t,"y",e),this.listenTo(t,"height",e),this.listenTo(t,"boundsy",e),this.listenTo(t,"boundsheight",e)),this.listenTo(t,"visible",e)},e.prototype.stopMonitoringSubview=function(t){var e;return e=this.update.bind(this),"x"===this.axis?(this.stopListening(t,"x",e),this.stopListening(t,"width",e),this.stopListening(t,"boundsx",e),this.stopListening(t,"boundswidth",e)):(this.stopListening(t,"y",e),this.stopListening(t,"height",e),this.stopListening(t,"boundsy",e),this.stopListening(t,"boundsheight",e)),this.stopListening(t,"visible",e)},e.prototype.update=function(){var t,e,i,n,s,r,o;if(!this.locked&&this.axis){if(this.locked=!0,r=this.subviews,t=r.length,i=Math.max,n=this.parent,e=0,"x"===this.axis){for(;t;)s=r[--t],this._skipX(s)||(e=i(e,s.boundsx+i(0,s.boundswidth)));o=e+n.__fullBorderPaddingWidth,n.width!==o&&(n.__noSpecialValueHandling=!0,n.setAttribute("width",o))}else{for(;t;)s=r[--t],this._skipY(s)||(e=i(e,s.boundsy+i(0,s.boundsheight)));o=e+n.__fullBorderPaddingHeight,n.height!==o&&(n.__noSpecialValueHandling=!0,n.setAttribute("height",o))}return this.locked=!1}},e.prototype._skipX=function(t){return!t.visible||null!=t.__percentFuncwidth||null!=t.__percentFuncx||null!=t.__alignFuncx&&!t.__alignFuncx.autoOk},e.prototype._skipY=function(t){return!t.visible||null!=t.__percentFuncheight||null!=t.__percentFuncy||null!=t.__alignFuncy&&!t.__alignFuncy.autoOk},e}(p),b=function(){function t(t){null==t&&(t=[]),this._boundingBox=null,this.vectors=t}return t.prototype.degreesToRadians=function(t){return t*Math.PI/180},t.prototype.radiansToDegrees=function(t){return 180*t/Math.PI},t.prototype.translate=function(t,e){var i,n;for(n=this.vectors,i=n.length;i;)n[--i]+=e,n[--i]+=t;return this._boundingBox=null,this},t.prototype.rotate=function(t){var e,i,n,s,r,o,a;for(t=this.degreesToRadians(t),e=Math.cos(t),s=Math.sin(t),r=this.vectors,n=r.length,i=0;n>i;)o=r[i]*e-r[i+1]*s,a=r[i]*s+r[i+1]*e,r[i++]=o,r[i++]=a;return this._boundingBox=null,this},t.prototype.scale=function(t,e){var i,n;for(n=this.vectors,i=n.length;i;)n[--i]*=e,n[--i]*=t;return this._boundingBox=null,this},t.prototype.transformAroundOrigin=function(t,e,i,n,s){return this.translate(-n,-s).rotate(i).scale(t,e).translate(n,s)},t.prototype.getBoundingBox=function(){var t,e,i,n,s,r,o,a;if(this._boundingBox)return this._boundingBox;if(r=this.vectors,t=r.length,t>=2){for(s=i=r[--t],n=e=r[--t];t;)a=r[--t],o=r[--t],s=Math.min(a,s),i=Math.max(a,i),n=Math.min(o,n),e=Math.max(o,e);return this._boundingBox={x:n,y:s,width:e-n,height:i-s}}return this._boundingBox=null},t}(),_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.register=function(){return e.__super__.register.apply(this,arguments),this.startEventTest()?this.startEvent():void 0},e.prototype.unregister=function(){return e.__super__.unregister.apply(this,arguments),this.startEventTest()?void 0:this.stopEvent()},e.prototype.startEvent=function(){return this.eventStarted?void 0:this.eventStarted=!0},e.prototype.stopEvent=function(){return this.eventStarted?this.eventStarted=!1:void 0},e}(u),J=Date.now(),B=function(){var t,e,i,n;return e=k.raf,e||(e=function(){return function(t){var e;return e=function(){return t(Date.now()-J)},window.setTimeout(e,1e3/60)}}()),n=!1,i=[],t=function(t){var e;for(e in i)i[e]&&(i[e](t),i[e]=null);return n=!1},function(s,r){return n||(e(t),n=!0),i[s]=r}}(),x=function(){var t,e;return e=[],t=function(i){var n,s,r,o;for(s=e,e=[],r=0,o=s.length;o>r;r++)(n=s[r])(i);e.length&&setTimeout(function(){return B(2,t)},0)},k.raf?function(i){e.push(i),B(2,t)}:function(t){setTimeout(function(){return t(Date.now()-J)},0)}}(),h=function(t){function e(){return this.sender=o(this.sender,this),this.startEvent=o(this.startEvent,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.startEventTest=function(){var t,e;return t=null!=(e=this.events.idle)?e.length:void 0,t?t:void 0},e.prototype.startEvent=function(){e.__super__.startEvent.apply(this,arguments),B(1,this.sender)},e.prototype.sender=function(t){return this.sendEvent("idle",t),setTimeout(function(t){return function(){return B(1,t.sender)}}(this),0)},e.prototype.callOnIdle=function(t){return x(t)},e}(_),W=["click","mouseover","mouseout","mousedown","mouseup"],f=function(t){function e(){this.sender=o(this.sender,this),this.handle=o(this.handle,this),this.touchHandler=o(this.touchHandler,this),this.x=0,this.y=0,this.docSelector=$(document),this.docSelector.on(W.join(" "),this.handle),this.docSelector.on("mousemove",this.handle).one("mouseout",this.stopEvent),k.touch&&(document.addEventListener("touchstart",this.touchHandler,!0),document.addEventListener("touchmove",this.touchHandler,!0),document.addEventListener("touchend",this.touchHandler,!0),document.addEventListener("touchcancel",this.touchHandler,!0))}var i,n,r;return s(e,t),r=function(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,!1},e.prototype.startEventTest=function(){var t,e,i;return(null!=(t=this.events.mousemove)?t.length:void 0)||(null!=(e=this.events.x)?e.length:void 0)||(null!=(i=this.events.y)?i.length:void 0)},e.prototype.sendMouseEvent=function(t,e){var i;return i=document.createEvent("MouseEvent"),i.initMouseEvent(t,!0,!0,window,1,e.pageX,e.pageY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i),e.target.$view&&"inputtext"!==e.target.$view.$tagname?r(event):void 0},i=null,n=null,e.prototype.touchHandler=function(t){var e,s,r;switch(r=t.changedTouches,e=r[0],t.type){case"touchstart":return this.sendMouseEvent("mouseover",e),this.sendMouseEvent("mousedown",e),i=e.target;case"touchmove":return s=document.elementFromPoint(e.pageX-window.pageXOffset,e.pageY-window.pageYOffset),s&&s.$view&&(n&&n!==s&&this.handle({target:n,type:"mouseout"}),n=s,this.handle({target:s,type:"mouseover"})),this.sendMouseEvent("mousemove",e);case"touchend":if(this.sendMouseEvent("mouseup",e),i===e.target)return this.sendMouseEvent("click",e),i=null}},e.prototype.handle=function(t){var e,i;return i=t.target.$view,e=t.type,i&&"mousedown"===e&&(this._lastMouseDown=i,"inputtext"!==i.$tagname&&r(t)),"mouseup"===e&&this._lastMouseDown&&this._lastMouseDown!==i?(this.sendEvent("mouseup",this._lastMouseDown),this._lastMouseDown.sendEvent("mouseup",this._lastMouseDown),this.sendEvent("mouseupoutside",this._lastMouseDown),this._lastMouseDown.sendEvent("mouseupoutside",this._lastMouseDown),void(this._lastMouseDown=null)):(i&&i.sendEvent(e,i),this.x=t.pageX,this.y=t.pageY,void(this.eventStarted&&"mousemove"===e?B(0,this.sender):this.sendEvent(e,i)))},e.prototype.sender=function(){return this.sendEvent("mousemove",{x:this.x,y:this.y}),this.sendEvent("x",this.x),this.sendEvent("y",this.y)},e.prototype.handleDocEvent=function(t){return t&&t.target!==document?void 0:this.eventStarted?this.docSelector.on("mousemove",this.handle).one("mouseout",this.stopEvent):this.docSelector.on("mousemove",this.handle).one("mouseout",this.startEvent)},e}(_),w=function(t){function e(){this.handle=o(this.handle,this);var t,e,i;window.addEventListener("resize",this.handle,!1),this.visible=!0,null!=document.hidden?(e="hidden",i="visibilitychange"):null!=document.mozHidden?(e="mozHidden",i="mozvisibilitychange"):null!=document.msHidden?(e="msHidden",i="msvisibilitychange"):null!=document.webkitHidden&&(e="webkitHidden",i="webkitvisibilitychange"),t=function(t){return function(){return t.visible=document[e],t.sendEvent("visible",t.visible)}}(this),document.addEventListener(i,t,!1),this.handle()}return s(e,t),e.prototype.startEventTest=function(){var t,e;return(null!=(t=this.events.width)?t.length:void 0)||(null!=(e=this.events.height)?e.length:void 0)},e.prototype.handle=function(){this.width=window.innerWidth,this.sendEvent("width",this.width),this.height=window.innerHeight,this.sendEvent("height",this.height)
},e}(_),d=function(t){function e(){this.handle=o(this.handle,this),this.keys={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},$(document).on("select change keyup keydown",this.handle)}return s(e,t),e.prototype.handle=function(t){var e,i,n;i=t.target.$view,n=t.type;for(e in this.keys)this.keys[e]=t[e];return this.keys.type=n,i&&i.sendEvent(n,this.keys),"select"!==n&&"change"!==n?(this.sendEvent(n,this.keys),this.sendEvent("keys",this.keys)):void 0},e}(u),window.onerror=function(t){return Y([""+t.toString()+". Try running in debug mode for more info. "+window.location.href+(q?"&":"?")+"debug"])},M={view:m,"class":a,node:g,mouse:new f,keyboard:new d,window:new w,layout:p,idle:new h,state:y,_noop:D,initElements:L.initAllElements,writeCSS:L.writeCSS,initConstraints:ie}}(),dr.writeCSS(),$(window).on("load",function(){return dr.initElements(),t(!0)})}).call(this);